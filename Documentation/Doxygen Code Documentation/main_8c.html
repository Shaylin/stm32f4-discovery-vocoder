<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>STM32F4 Vocoder: main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STM32F4 Vocoder
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">A record and playback voice modifier</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('main_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;stm32f4xx.h&quot;</code><br />
<code>#include &quot;stm32f4_discovery.h&quot;</code><br />
<code>#include &quot;<a class="el" href="audio__out_8h_source.html">audio_out.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="audio__in_8h_source.html">audio_in.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="audio__process_8h_source.html">audio_process.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buttons_8h_source.html">buttons.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="lcd_8h_source.html">lcd.h</a>&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aaf6ce196dde98712e1223b99766e06c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aaf6ce196dde98712e1223b99766e06c0">DMA2_Stream0_IRQHandler</a> (void)</td></tr>
<tr class="memdesc:aaf6ce196dde98712e1223b99766e06c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt handler which is triggered when DMA2_Stream0, or the ADC signal input has filled the buffer.  <a href="#aaf6ce196dde98712e1223b99766e06c0">More...</a><br /></td></tr>
<tr class="separator:aaf6ce196dde98712e1223b99766e06c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac201b60d58b0eba2ce0b55710eb3c4d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ac201b60d58b0eba2ce0b55710eb3c4d0">DMA1_Stream5_IRQHandler</a> (void)</td></tr>
<tr class="memdesc:ac201b60d58b0eba2ce0b55710eb3c4d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt handler which is triggered when DMA1_Stream5, or the DAC signal output has gone through the buffer.  <a href="#ac201b60d58b0eba2ce0b55710eb3c4d0">More...</a><br /></td></tr>
<tr class="separator:ac201b60d58b0eba2ce0b55710eb3c4d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="memdesc:a840291bc02cba5474a4cb46a9b9566fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main loop which runs through the following procedures: Wait for button input to begin audio input, Wait for completion of input and for process flag to be set to begin audio processing, Begin audio output when processing is done, reset all flags when output is complete and wait once more for button input.  <a href="#a840291bc02cba5474a4cb46a9b9566fe">More...</a><br /></td></tr>
<tr class="separator:a840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a020b90d50e29c81842d4334a910a4edc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a020b90d50e29c81842d4334a910a4edc">EVAL_AUDIO_TransferComplete_CallBack</a> (uint32_t pBuffer, uint32_t Size)</td></tr>
<tr class="separator:a020b90d50e29c81842d4334a910a4edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a083526166f89787eaf0234b5bc421039"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a083526166f89787eaf0234b5bc421039">EVAL_AUDIO_GetSampleCallBack</a> (void)</td></tr>
<tr class="separator:a083526166f89787eaf0234b5bc421039"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6aacbe21d3f34878936b32951083c3cb"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a6aacbe21d3f34878936b32951083c3cb">currentEffect</a> = 0</td></tr>
<tr class="memdesc:a6aacbe21d3f34878936b32951083c3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable that keeps track of the current effect being used to process the input signal. 0 = Darth Vader, 1 = Imperial Probe Droid.  <a href="#a6aacbe21d3f34878936b32951083c3cb">More...</a><br /></td></tr>
<tr class="separator:a6aacbe21d3f34878936b32951083c3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80605fad066e6989f208c6e2a657ad0c"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a80605fad066e6989f208c6e2a657ad0c">inputDone</a> = 1</td></tr>
<tr class="memdesc:a80605fad066e6989f208c6e2a657ad0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag which is set high when the audio input has been completed.  <a href="#a80605fad066e6989f208c6e2a657ad0c">More...</a><br /></td></tr>
<tr class="separator:a80605fad066e6989f208c6e2a657ad0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf80d666b854eb1570d2e35e75e12731"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aaf80d666b854eb1570d2e35e75e12731">outputDone</a> = 1</td></tr>
<tr class="memdesc:aaf80d666b854eb1570d2e35e75e12731"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag which is set high when the audio output has been completed.  <a href="#aaf80d666b854eb1570d2e35e75e12731">More...</a><br /></td></tr>
<tr class="separator:aaf80d666b854eb1570d2e35e75e12731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c2163e9cd7671201227fbd87cbbb9e0"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a8c2163e9cd7671201227fbd87cbbb9e0">process</a> = 0</td></tr>
<tr class="memdesc:a8c2163e9cd7671201227fbd87cbbb9e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag which is set high to indicate the the audio input requires processing.  <a href="#a8c2163e9cd7671201227fbd87cbbb9e0">More...</a><br /></td></tr>
<tr class="separator:a8c2163e9cd7671201227fbd87cbbb9e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4810d3c3a5cd6c8b3b112b3cca5b8b9c"><td class="memItemLeft" align="right" valign="top">uint16_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a4810d3c3a5cd6c8b3b112b3cca5b8b9c">buffer</a></td></tr>
<tr class="memdesc:a4810d3c3a5cd6c8b3b112b3cca5b8b9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the unsigned 16-bit integer signal buffer.  <a href="#a4810d3c3a5cd6c8b3b112b3cca5b8b9c">More...</a><br /></td></tr>
<tr class="separator:a4810d3c3a5cd6c8b3b112b3cca5b8b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2c6b258f02add8fdf4cfc7c371dd772"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a> = 64000</td></tr>
<tr class="memdesc:ab2c6b258f02add8fdf4cfc7c371dd772"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the signal buffer.  <a href="#ab2c6b258f02add8fdf4cfc7c371dd772">More...</a><br /></td></tr>
<tr class="separator:ab2c6b258f02add8fdf4cfc7c371dd772"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac201b60d58b0eba2ce0b55710eb3c4d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DMA1_Stream5_IRQHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interrupt handler which is triggered when DMA1_Stream5, or the DAC signal output has gone through the buffer. </p>

</div>
</div>
<a class="anchor" id="aaf6ce196dde98712e1223b99766e06c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DMA2_Stream0_IRQHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interrupt handler which is triggered when DMA2_Stream0, or the ADC signal input has filled the buffer. </p>

</div>
</div>
<a class="anchor" id="a083526166f89787eaf0234b5bc421039"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t EVAL_AUDIO_GetSampleCallBack </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a020b90d50e29c81842d4334a910a4edc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EVAL_AUDIO_TransferComplete_CallBack </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>Size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a840291bc02cba5474a4cb46a9b9566fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main loop which runs through the following procedures: Wait for button input to begin audio input, Wait for completion of input and for process flag to be set to begin audio processing, Begin audio output when processing is done, reset all flags when output is complete and wait once more for button input. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a4810d3c3a5cd6c8b3b112b3cca5b8b9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t* buffer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to the unsigned 16-bit integer signal buffer. </p>

</div>
</div>
<a class="anchor" id="a6aacbe21d3f34878936b32951083c3cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t currentEffect = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variable that keeps track of the current effect being used to process the input signal. 0 = Darth Vader, 1 = Imperial Probe Droid. </p>

</div>
</div>
<a class="anchor" id="a80605fad066e6989f208c6e2a657ad0c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t inputDone = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag which is set high when the audio input has been completed. </p>

</div>
</div>
<a class="anchor" id="aaf80d666b854eb1570d2e35e75e12731"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t outputDone = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag which is set high when the audio output has been completed. </p>

</div>
</div>
<a class="anchor" id="a8c2163e9cd7671201227fbd87cbbb9e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t process = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag which is set high to indicate the the audio input requires processing. </p>

</div>
</div>
<a class="anchor" id="ab2c6b258f02add8fdf4cfc7c371dd772"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t size = 64000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of the signal buffer. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="main_8c.html">main.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
